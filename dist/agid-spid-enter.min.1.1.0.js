"use strict";window.AgidSpidEnter=function(){var n=this,i=void 0,e=void 0,t=void 0,a=void 0;function o(i,e){return n.tpl[i].call(n,e)}function s(n){n.removeAttribute("hidden")}function r(n){var i=document.createAttribute("hidden");n.setAttributeNode(i)}function d(n){var i=setInterval(function(){return n.focus()},100);a.addEventListener("focus",function(){return clearInterval(i)})}function c(){r(t),t.innerHTML="",d(a)}function l(n){t.innerHTML=o("infoModalContent",n),s(t),document.querySelector("#closemodalbutton").addEventListener("click",c)}function u(n){var i=27===n.keyCode,e=!t.hasAttribute("hidden");i&&(e?c():g())}function p(){!function(){for(var n=e.children.length;n>=0;n--)e.appendChild(e.children[Math.random()*n|0])}(),s(i),d(a),document.addEventListener("keyup",u)}function g(){r(i),document.removeEventListener("keyup",u)}function m(){var i=document.querySelectorAll(".agid-spid-enter-button"),e=Array.from(i),t=e.length;n.availableProviders?t?(e.forEach(function(n){var i=n.getAttribute("data-size"),e=i.toLowerCase(),t=["s","m","l","xl"];-1!==t.indexOf(e)?n.innerHTML=o("spidButton",e):console.error("Le dimenioni supportate sono",t,"trovato invece:",i,n)}),Array.from(document.querySelectorAll(".agid-spid-enter")).forEach(function(n){n.addEventListener("click",p)})):console.warn("Nessun placeholder HTML trovato nella pagina per i pulsanti SPID"):console.error("Si è verificato un errore nel caricamento dei providers, impossibile renderizzare i pulsanti SPID")}function v(n,i,e){return new Promise(function(t,a){var o=new XMLHttpRequest;o.open(n,i),o.onreadystatechange=function(){4===o.readyState&&(200===o.status&&o.responseText?t(JSON.parse(o.responseText)):a(o.responseText))},o.send(JSON.stringify(e))})}function h(){var i={language:n.language};return v("GET",n.config.localisationEndpoint,i)}function f(){(function(){var e;document.getElementById("agid-spid-enter-container")||(function(n){var i=document.createElement("link");i.rel="stylesheet",i.type="text/css",i.href=n,document.head.appendChild(i)}(n.config.stylesheetUrl),e="agid-spid-enter-container",(i=document.createElement("section")).id=e,r(i),document.body.insertBefore(i,document.body.firstChild),i.innerHTML=o("spidMainContainers"))})(),function(){var i=document.querySelector("#agid-spid-enter"),e="";n.availableProviders.forEach(function(n){e+=o("spidProviderButton",n)}),i.innerHTML=o("spidProviderChoiceModal",e),document.querySelector("#agid-spid-panel-close-button").addEventListener("click",g),document.querySelector("#agid-cancel-access-button").addEventListener("click",g),document.querySelector("#nospid").addEventListener("click",function(){return l(o("nonHaiSpid"))}),document.querySelector("#cosaspid").addEventListener("click",function(){return l(o("cosaSpid"))})}(),m(),e=document.querySelector("#agid-spid-idp-list"),t=document.querySelector("#agid-infomodal"),a=document.querySelector("#agid-spid-panel-select")}function b(i){n.language=i.language||n.language,n.formActionUrl=i.formActionUrl||n.formActionUrl,n.formSubmitMethod=i.formSubmitMethod||n.formSubmitMethod}return n.availableProviders=null,{init:function(i){var e;return i&&b(i),e=[h(),v("GET",n.config.providersEndpoint)],Promise.all(e).then(function(e){n.i18n=e[0],function(i,e){var t=[];i.forEach(function(n){n.isActive&&(n.payload=e?Object.assign({},e.common,e[n.provider]):{}),t.push(n)}),n.availableProviders=t}(e[1].spidProviders,i&&i.providersPayload),f()}).catch(function(i){n.availableProviders=null,console.error("Si è verificato un errore nel caricamento dei dati",i)})},changeLanguage:function(i){return b({language:i}),h().then(function(i){n.i18n=i,f()}).catch(function(n){console.error("Si è verificato un errore nel caricamento dei dati",n)})},updateSpidButtons:m,version:function(){return n.config.version}}},window.AgidSpidEnter.prototype.tpl={spidMainContainers:function(){return'\n        <div id="agid-spid-enter"></div>\n        <div id="agid-infomodal" class="modal" aria-live="assertive" tabindex="0" hidden></div>\n    '},svgWithPngFallback:function(n,i){return'\n            <img aria-hidden="true"\n                src="'.concat(this.config.assetsBaseUrl).concat(n,'.svg"\n                onerror="this.src=\'').concat(this.config.assetsBaseUrl).concat(n,'.png\'; this.onerror=null;"\n                alt="').concat(i,'" />\n        ')},spidProviderChoiceModal:function(n){return'\n            <div id="agid-spid-enter-anim"></div>\n            <section id="agid-spid-panel-select" aria-labelledby="agid-spid-enter-title-page" tabindex="0">\n                <header id="agid-spid-panel-header">\n                    <nav class="agid-spid-panel-back agid-spid-panel-element" aria-controls="agid-spid-panel-select">\n                        <button tabindex="0" id="agid-spid-panel-close-button" class="agid-spid-button agid-navigable" aria-labelledby="agid-cancel-access-button">\n                            '.concat(this.tpl.svgWithPngFallback.call(this,"img/x-icon",this.getI18n("naviga_indietro")),'\n                        </button>\n                    </nav>\n                    <div class="agid-spid-panel-logo agid-spid-panel-element">\n                        ').concat(this.tpl.svgWithPngFallback.call(this,"img/spid-logo-c-lb",this.getI18n("alt_logo_SPID")),'\n                    </div>\n                </header>\n                <div id="agid-spid-panel-content">\n                    <div class="agid-spid-panel-content-center">\n                        <div id ="agid-spid-enter-title-container">\n                            <h1 id="agid-spid-enter-title-page" class="agid-font">').concat(this.getI18n("scegli_provider_SPID"),'</h1>\n                        </div>\n                        <div id="agid-spid-idp-list" class="agid-spid-row">\n                            ').concat(n,'\n                        </div>\n                        <div id="agid-cancel-access-container">\n                            <button id="agid-cancel-access-button" class="agid-transparent-button agid-font agid-navigable">\n                                <span>').concat(this.getI18n("annulla_accesso"),'</span>\n                            </button>\n                        </div>\n                        <div id="agid-logo-container" aria-hidden="true">\n                            ').concat(this.tpl.svgWithPngFallback.call(this,"img/agid-logo-bb-short"),'\n                        </div>\n                    </div>\n                </div>\n                <footer id="agid-spid-panel-footer">\n                    <div id="agid-action-button-container">\n                        <button id="nospid" class="agid-action-button agid-font agid-navigable">\n                            <span>').concat(this.getI18n("non_hai_SPID"),'</span>\n                        </button>\n                        <button id="cosaspid" class="agid-action-button agid-font agid-navigable">\n                            <span>').concat(this.getI18n("cosa_SPID"),"</span>\n                        </button>\n                    </div>\n                </footer>\n            </section>\n        ")},hiddenField:function(n,i){return'<input type="hidden" name="'.concat(n,'" value="').concat(i,'" />')},spidProviderButton:function(n){var i=n.isActive,e=n.title,t=n.payload,a=n.provider,o=n.logo,s=i?this.getI18n("accedi_con_idp",e):this.getI18n("idp_disabled"),r="provider",d="";if(t)for(var c in r=t.providerHiddenName||r,delete t.providerHiddenName,d+=this.tpl.hiddenField(r,a),t)d+=this.tpl.hiddenField(c,t[c]);return'\n            <span class="agid-spid-col l3 m6 s6 xs12">\n                <form id="agid-spid-provider-'.concat(a,'"\n                    action="').concat(this.formActionUrl,'" method="').concat(this.formSubmitMethod,'">\n                    <button type="submit"\n                        class="agid-spid-idp-button agid-spid-idp-').concat(a,'"\n                        title="').concat(s,'"\n                        style="background-image: url(\'').concat(this.config.assetsBaseUrl,"img/idp-logos/").concat(o,"')\"\n                        ").concat(i?"":"disabled",">\n                    </button>\n                    ").concat(d,"\n                </form>\n            </span>\n        ")},spidButton:function(n){return"\n            \x3c!-- AGID - SPID BUTTON ".concat(n.toUpperCase(),' * begin * --\x3e\n            <button class="agid-spid-enter agid-font agid-spid-enter-size-').concat(n,'" hidden>\n                <span aria-hidden="true" class="agid-spid-enter-icon">\n                        ').concat(this.tpl.svgWithPngFallback.call(this,"img/spid-ico-circle-bb",this.getI18n("entra_con_SPID")),'\n                </span>\n                <span class="agid-spid-enter-text">').concat(this.getI18n("entra_con_SPID"),"</span>\n            </button>\n            \x3c!-- AGID - SPID BUTTON ").concat(n.toUpperCase()," * end * --\x3e\n        ")},infoModalContent:function(n){return'\n            <div class="modal-content agid-font">\n                <button id="closemodalbutton"\n                    class="close agid-navigable"\n                    tabindex="0"\n                    aria-label="'.concat(this.getI18n("aria_chiudi_modale"),'">\n                    <b aria-hidden="true">&times;</b>\n                </button>\n                <div id="agid-infomodal-content" role="main" tabindex="0" aria-labelledby="agid-infomodal-title">\n                    ').concat(n,"\n                </div>\n            </div>\n        ")},nonHaiSpid:function(){return'\n        <h1 id="agid-infomodal-title">Non hai Spid?</h1>\n        <ul>\n            <li>Morbi in sem quis dui placerat ornare. Pellentesque odio nisi, euismod in, pharetra a, ultricies in, diam.\n            Sed arcu. Cras consequat.</li>\n            <li>Praesent dapibus, neque id cursus faucibus, tortor neque egestas augue, eu vulputate magna eros eu erat.\n            Aliquam erat volutpat. Nam dui mi, tincidunt quis, accumsan porttitor, facilisis luctus, metus.</li>\n            <li>Phasellus ultrices nulla quis nibh. Quisque a lectus. Donec consectetuer ligula vulputate sem tristique cursus.\n            Nam nulla quam, gravida non, commodo a, sodales sit amet, nisi.</li>\n            <li>Pellentesque fermentum dolor. Aliquam quam lectus, facilisis auctor, ultrices ut, elementum vulputate, nunc.</li>\n        </ul>    \n    '},cosaSpid:function(){return'\n        <h1 id="agid-infomodal-title">Cosa è SPID</h1>\n        <p>\n            <strong>Pellentesque habitant morbi tristique</strong> senectus et netus et malesuada fames ac turpis egestas.\n            Vestibulum tortor quam, feugiat vitae, ultricies eget, tempor sit amet, ante.\n            Donec eu libero sit amet quam egestas semper. <em>Aenean ultricies mi vitae est.</em> Mauris placerat eleifend leo.\n            Quisque sit amet est et sapien ullamcorper pharetra.\n            Vestibulum erat wisi, condimentum sed, <code>commodo vitae</code>, ornare sit amet, wisi.\n            Aenean fermentum, elit eget tincidunt condimentum, eros ipsum rutrum orci, sagittis tempus lacus enim ac dui.\n            <a href="#">Donec non enim</a> in turpis pulvinar facilisis. Ut felis.\n        </p>\n        <h2>Header Level 2</h2>\n        <ol>\n            <li>Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</li>\n            <li>Aliquam tincidunt mauris eu risus.</li>\n        </ol>\n        <blockquote>\n            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus magna. Cras in mi at felis aliquet congue. Ut a est eget ligula molestie gravida.\n            Curabitur massa. Donec eleifend, libero at sagittis mollis, tellus est malesuada tellus, at luctus turpis elit sit amet quam. Vivamus pretium ornare est.</p>\n        </blockquote>\n        <h3>Header Level 3</h3>\n        <ul>\n            <li>Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</li>\n            <li>Aliquam tincidunt mauris eu risus.</li>\n        </ul>\n    '}},window.AgidSpidEnter.prototype.language="it",window.AgidSpidEnter.prototype.i18n={},window.AgidSpidEnter.prototype.getI18n=function(n,i){var e=this.language,t=this.i18n.language&&this.i18n.language[e]&&this.i18n.language[e][n];return i&&(t=t.replace(/\{\d}/,i)),t||console.error("La chiave richiesta non è disponibile nel locale selezionato:",e,n),t||n},window.AgidSpidEnter.prototype.config={version:"1.1.0",assetsBaseUrl:"https://rawgit.com/srescio/spid-smart-button/issue-2/separate-html-js/",stylesheetUrl:"https://rawgit.com/srescio/spid-smart-button/issue-2/separate-html-js/prod/agid-spid-enter.min.1.1.0.css",providersEndpoint:"https://rawgit.com/srescio/spid-smart-button/issue-2/separate-html-js/src/data/spidProviders.json",localisationEndpoint:"https://rawgit.com/srescio/spid-smart-button/issue-2/separate-html-js/src/data/spidI18n.json"},window.agidSpidEnter=new window.AgidSpidEnter;